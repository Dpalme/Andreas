<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ANDREAS - Klaatu Suuns</title>
    <link rel="shortcut icon" href="./img/x.svg" type="image/x-icon" />
    <link
      href="https://dpalmer.in/Peoria/css/peoria-0-6-2.min.css"
      rel="stylesheet"
    />
    <link href="./styles.css" rel="stylesheet" />
  </head>
  <body class="overflow-h" v-scope id="body">
    <div class="text-c fade" id="logos">
      <h1>
        <img src="./img/Andreas_Type.svg" alt="Andreas" />
      </h1>
      <div class="flex-row">
        <img src="./img/Klaatu_Type.svg" alt="Klaatu Suuns" class="mr-lg" />
        <img src="./img/Spack_Type.svg" alt="Speck Joliet" />
      </div>
    </div>

    <div class="text-c center-a fade">
      <a href="./" class="text-c">
        <img src="./img/play_circle_filled.svg" alt="Play Icon" id="playIcon" />
      </a>
    </div>

    <div id="vueComp">
      <form
        class="text-c absolute bottom center-x mb-lg fade"
        id="formName"
        @submit.prevent="strip.getPlant"
      >
        <label for="name" class="white h4"
          >{{ i18b[i18b.lang].formLabel }}</label
        >
        <input
          type="text"
          :placeholder="i18b[i18b.lang].placeholder"
          v-model="name"
          maxlength="18"
        />
      </form>

      <div id="obiStrip" class="top left absolute">
        <div class="text-c p-sm">
          <a class="blue mr-md en-switch" @click="i18b.switchEn">EN</a>
          <a class="blue es-switch" @click="i18b.switchEs">ES</a>
        </div>
        <div id="obiInfo" class="relative">
          <div class="text-c p-sm border-blue relative">
            <h2 class="mb-n">{{ strip.name }}</h2>
            <h3 class="mb-n">{{ strip.plant[i18b.lang].name }}</h3>
            <img
              src="./img/ShareNetwork.svg"
              alt="share"
              height="24"
              class="icon"
              @click.prevent="strip.share"
            />
          </div>
          <div class="p-sm border-blue">
            <p class="justify mb-n">{{ strip.plant[i18b.lang].info }}</p>
          </div>
          <img
            :src="strip.plant.img.src"
            :alt="strip.plant[i18b.lang].name"
            width="360"
          />
          <div class="text-c p-sm">
            <h3>Tu canción</h3>
            <a
              :href="strip.plant.song.url"
              class="d-block button white blue-bg m-n"
            >
              {{ strip.plant.song.name }}
            </a>
          </div>
        </div>
        <div class="text-c p-sm border-blue">
          <p class="mb-sm">{{ i18b[i18b.lang].shareText }}</p>
          <a
            target="_blank"
            class="button white blue-bg d-block m-n"
            @click.prevent="strip.share"
            >{{ i18b[i18b.lang].shareCTA }}</a
          >
        </div>
        <div class="text-c p-sm border-blue">
          {{ i18b[i18b.lang].videoCTA }}
        </div>
        <a href="https://youtu.be" class="d-block m-n">
          <img src="" alt="" width="360" />
        </a>
      </div>
    </div>

    <footer
      class="absolute bottom right flex-row"
      id="branding"
      style="justify-items: center"
    >
      <a href="https://dpalmer.in">
        <img src="./img/dpalmer_in.svg" alt="dpalmer.in" height="16" />
      </a>
      <img src="./img/x.svg" alt="x" height="16" />
      <a href="https://superartificial.com.mx">
        <img src="./img/SuperArt.svg" alt="Super Artificial" height="16" />
      </a>
    </footer>
    <script src="js/md5.min.js"></script>
    <script type="module">
      import { createApp, reactive } from "https://unpkg.com/petite-vue?module";
      import { plants } from "./js/output.js";

      const strip = reactive({
        plant: {
          es: {
            name: "Nombre español",
            info: "Info español",
          },
          en: {
            name: "Nombre inglés",
            info: "Info inglés ",
          },
          song: {
            name: "Canción ",
            url: "Canción ",
          },
          img: {
            src: "./img/plants/narciso.jpeg",
          },
        },
        getPlant(ev) {
          this.name = ev.target[0].value;
          if (this.name && this.name != "") {
            document.getElementById("obiStrip").classList.add("open");
            var hashStr = md5(name),
              hash = 0;
            for (var i = 0; i < md5.length; i++) {
              hash += hashStr.charCodeAt(i);
            }
            const keys = Object.keys(plants);
            this.plant = plants[keys[hash % keys.length]];
          }
        },
        share(ev) {
          if (navigator.share) {
            navigator
              .share({
                title: this.plant[i18b.lang].name,
                text: this.plant[i18b.lang].name,
                url: window.location.href,
                img: this.plant.img.src
              })
              .then(() => {
                console.log("Thanks for sharing!");
              })
              .catch((err) => {
                console.log(`Couldn't share because of`, err.message);
              });
          } else {
            window.open(`https://twitter.com/intent/tweet?url=http%3A%2F%2F192.168.68.125%3A5500&text=A%20m%ED%20me%20toc%F3%20${this.plant.es.name}%2C%20t%FA%20qu%E9%20eres%3F`, '_blank');
          }
        },
      });

      const i18b = reactive({
        lang: "es",
        es: {
          formLabel: "Gana una sorpresa",
          placeholder: "Tu Nombre",
          shareText:
            "Comparte lo que te salió y participa para ganar un cassette de PANORAMAS",
          shareCTA: "Compartir",
          viewCTA: "Ve el video de ANDREAS",
        },
        en: {
          formLabel: "Win a surprise",
          placeholder: "Your Name",
          shareText:
            "Share what you got for a chance to win a PANORAMAS cassette",
          shareCTA: "Share",
          viewCTA: "Watch the ANDREAS video",
        },
        switchEn() {
          this.lang = "en";
          document.querySelector(".en-switch").classList.add("active");
          document.querySelector(".es-switch").classList.remove("active");
        },
        switchEs() {
          this.lang = "es";
          document.querySelector(".en-switch").classList.remove("active");
          document.querySelector(".es-switch").classList.add("active");
        },
      });

      createApp({ i18b, strip }).mount("#body");

      if ("es" in window.navigator.languages) {
        i18b.switchEs();
      } else {
        i18b.switchEn();
      }
    </script>
  </body>
</html>
